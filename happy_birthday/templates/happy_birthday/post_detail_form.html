{% extends "layout.html" %}
{% load bootstrap4 static %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="card-body col-sm-12">
                <div class="mb-3">
                    <img src="{{ post.author.profile_image_url }}" class="rounded-circle" style="width: 100px; height: 100px;" />
                    {{ post.author }}
                </div>
                <div class="mb-3">
                    {{ post.content }} <br><br>
                    {{ post.created_at }}
                </div>
                {% if post.author == user %}
                    <a class="btn btn-primary mr-3" href="{% url 'happy_birthday:post_edit' pk=post.pk %}">내가 쓴 편지 수정</a>
                    <a class="btn btn-danger" href="{% url 'happy_birthday:post_delete' pk=post.pk %}">편지 삭제하기</a>
                {% else %}
                    <a class="btn btn-warning" href="{% url 'happy_birthday:post_edit' pk=post.pk %}">남이 쓴 편지 수정</a>
                {% endif %}
            </div>

            {% for comment in comments %}
                <div class="col-sm-12 mb-3">
                    <div class="col-sm-8 mb-3">
                        <img src="{{ comment.author.profile_image_url }}" class="rounded-circle mr-2" style="width: 32px; height: 32px;" />
                        {{ comment.author }} | {{ comment.content }} <br>
                        {{ comment.created_at }}
                    </div>
                    {% if user == comment.author %}
                        <div class="col-sm-3">
                            <form action="{% url 'happy_birthday:comment_delete' post.pk comment.pk %}" method="POST">
                                {% csrf_token %}
                                <input class="btn btn-danger" type="submit" value="삭제"/>
                            </form>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}

            {% if user.is_authenticated %}
                <div class="card-body col-sm-12">
                    <form action="{% url 'happy_birthday:comment_new' post.pk %}" method="POST">
                        {% csrf_token %}
                        {% bootstrap_form comment_form %}

                        <input class="btn btn-primary" type="submit" value="게시"/>
                    </form>
                </div>
            {% endif %}

        </div>
    </div>
{% endblock %}
